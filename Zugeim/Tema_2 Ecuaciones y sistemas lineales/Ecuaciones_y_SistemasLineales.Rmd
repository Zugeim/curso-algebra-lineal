---
title: "Ecuaciones y sistemas lineales"
author: "Imanol"
date: "11/3/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

knitr::opts_chunk$set(engine.path = list(matlab = "C:/Archivos de programa/MATLAB/R2020b/bin/matlab.exe"))

library(reticulate)
use_python("../../../anaconda3/envs/Curso Algebra Lineal/python.exe")

# Para que no de errores el QT
py_run_string("import os as os")
py_run_string("os.environ['QT_QPA_PLATFORM_PLUGIN_PATH'] = 'C:/Users/imano/anaconda3/Library/plugins/platforms'")
```

# R 

## Sistemas compatibles determinados.

### Resolver Sistemas Compatibles Determinados con *solve()*
```{r}
A = rbind(c(1,1,2),c(2,4,-3),c(3,6,-5))
b = c(9,1,0)
AB = cbind(A,b) # Unimos matriz A y b

# Comprobar si es compatible determinado
qr(A)$rank==qr(AB)$rank # Compatible
qr(A)$rank==3 # Determinado

# Resolver el sistema
solve(A,b) 

# Comprobacion
solution = c(1,2,3)
A%*%solution == b # Confirmado, nos da el vector de terminos independientes.
```


### Resolver Sistemas Compatibles Determinados con *matlib*
```{r}
A = rbind(c(2,2),c(-1,1))
b = c(1,2)
AB = cbind(A,b) # Unimos matriz A y b

library(matlib)

# Una vez en forma de matriz se puede mostrar
showEqn(A, b)

# Calcular rango de la matriz con matlib
R(A)
R(AB)

# Comprobar si el sistema es compatible con matlib
all.equal(R(A),R(AB))

# Resolver el sistema son matlib
Solve(A,b, fractions = TRUE) # En este cas la s es mayuscula.
                             # Si fractions es TRUE nos lo muestra en fracciones
```

### Representación de Sistemas.

Se hace uso de la libreria `matlib()` y mediante *plotEqn()* si tenemos 2 incognitas o *plotEqn3()* si tenemos 3 incognitas.
```{r}
library(matlib)

# Representacion con plotEqn()

## Dos Incognitas

### Dos ecuaciones
A = rbind(c(2,2),c(-1,1))
b = c(1,2)
AB = cbind(A,b) # Unimos matriz A y b
plotEqn(A,b)

points(-3/4,5/4, col = "turquoise1", pch = 19) # Para dibujar puntos con ciertas caracteristicas

#### Tres ecuaciones
A = rbind(c(4,2),c(1,-2),c(3,4))
b = c(3,2,1)
showEqn(A,b)
plotEqn(A,b)

## Tres Incognitas

A = rbind(c(1,1,2),c(2,4,-3),c(3,6,-5))
b = c(9,1,0)
showEqn(A,b)

plotEqn3d(A,b, xlim = c(-3,3), ylim = c(0,6))
```

### Tema 2 Ejercicio 1.

#### Solución (a)
```{r}
A = rbind(c(4,2),c(1,-2),c(3,4))
b = c(3,2,1)
showEqn(A,b)

AB = cbind(A,b)

all.equal(R(A),R(AB))
```

#### Solución (b)
```{r}
# Resolvemos
Solve(A,b,fractions = T)

#Comprobamos
s = c(1,-1/2)
A%*%s == b # Efectivamente es la correcta
```

# Python 

## Sistemas compatibles determinados.

### Resolver Sistemas Compatibles Determinados de manera normal.
```{python}
import numpy as np

A = np.array([[1,1,2],[2,4,-3],[3,6,-5]])
b = np.array([9,1,0])
AB = np.array([[1,1,2,9],[2,4,-3,1],[3,6,-5,0]])

#Comprobar que los rangos son iguales
np.linalg.matrix_rank(A) == np.linalg.matrix_rank(AB)

# Comprobar si ademas el rango es igual a las incognitas
np.linalg.matrix_rank(A) == 3

# Resolvemos
x = np.linalg.solve(A,b)
x

# Comprobamos
A.dot(x)
```


### Sistemas compatibles determinados con *sympy*
```{python}
from sympy import *
from sympy.solvers.solveset import linsolve

x,y,z = symbols('x,y,z') # Asi se declaran variables en Python
x1,x2,x3 = symbols('x1,x2,x3')

# Resolver introduciendo la lista de ecuaciones (la facil)
linsolve([2*x1 + 2*x2 - 1, -x1 + x2 - 2], (x1, x2))

# Resolver introduciendo la matriz aplicada
linsolve(Matrix(([2, 2, 1], [-1, 1, 2])), (x1, x2))

#Resolver introduciendo el sistema
AB = Matrix(((2, 2, 1), (-1, 1, 2))) #Matriz ampliada
A = AB[:, :-1] #Todas las filas de todas las columnas menos la ultima
b = AB[:, -1]#Todas las filas de la ultima columna
system = A,b
linsolve(system, x1, x2)
```

### Representación de Sistemas.

Se hace uso de la libreria `matplotlib.pyplot` 
```{python}
######################### Mejor hacer en jupyter que aqui no deja ver graficas

# Dos ecuaciones con 2 incognitas
import matplotlib.pyplot as plt
x1 = np.linspace(0, 10, 100)
plt.plot(x1, 1/2-x1, x1, (2+x1)/4) # Despejar y

# Tres ecuaciones con dos incognitas
x = np.linspace(0, 10, 100)
plt.plot(x, 3/2-2*x, x, x/2-1, x, (1-3*x)/4) # Despejar y

# Tres ecuaciones con 3 incognitas
from mpl_toolkits.mplot3d import Axes3D

point1  = np.array([0,0,9/2])  # Un punto valido que cumple la funcion
n1 = np.array([1,1,2])         # Los valores de la ecuacion

point2  = np.array([0,0,-1/3]) # Un punto valido que cumple la funcion
n2 = np.array([2,4,-3])        # Los valores de la ecuacion

point3  = np.array([0,0,0])    # Un punto valido que cumple la funcion
n3 = np.array([3,6,-5])        # Los valores de la ecuacion

D1 = -9 # Termino independiente
D2 = -1
D3 = 0

X, Y = np.meshgrid(range(30), range(30)) # Genero numeros de 0 a 29.

## Calculamos z en funcion de x e y
z1 = (-n1[0]*X - n1[1]*Y - D1)*1./n1[2]
z2 = (-n2[0]*X - n2[1]*Y - D2)*1./n2[2]
z3 = (-n3[0]*X - n3[1]*Y - D3)*1./n3[2]

plot3d = plt.figure().gca(projection='3d')
plot3d.plot_surface(X,Y,z1, color='red')
plot3d.plot_surface(X,Y,z2, color='cyan')
plot3d.plot_surface(X,Y,z3, color='yellow')
plt.show()
```


### Metodo de GAUSS.

No tiene nada

## Sistemas compatibles indeterminados.

```{python}
import numpy as np
from mpl_toolkits.mplot3d import Axes3D

A = np.array([[1,1,-1],[1,-1,1],[3,1,-1]])
B = np.array([2,1,5])
AB = np.array([[1,1,-1,2],[1,-1,1,1],[3,1,-1,5]])

# Comprobamos rangos de las matrices
np.linalg.matrix_rank(A)
np.linalg.matrix_rank(A)==np.linalg.matrix_rank(AB) 

# Tambien se puede ver dibujando que tiene infinitas soluciones
import matplotlib.pyplot as plt

point1  = np.array([0,0,-2])
n1 = np.array([1,1,-1])

point2  = np.array([0,0,1])
n2 = np.array([1,-1,1])

point3  = np.array([0,0,-5])
n3 = np.array([3,1,-1])

X, Y = np.meshgrid(range(30), range(30)) # Genero numeros de 0 a 29.

## Calculamos z en funcion de x e y
z1 = (-n1[0]*X - n1[1]*Y - D1)*1./n1[2]
z2 = (-n2[0]*X - n2[1]*Y - D2)*1./n2[2]
z3 = (-n3[0]*X - n3[1]*Y - D3)*1./n3[2]

## Creamos y dibujamos el plot
plot3d = plt.figure().gca(projection='3d')
plot3d.plot_surface(X,Y,z1, color='red')
plot3d.plot_surface(X,Y,z2, color='cyan')
plot3d.plot_surface(X,Y,z3, color='yellow')
plt.show()


```

## Sistemas Incompatibles.

```{python}
linsolve(Matrix(([1, 1, 2], [1, -1, 1], [2, 1, 3])), (x, y))
```

Es decir, que el conjunto de soluciones es el conjunto vacío, $\emptyset$. Esto se debe a que el sistema es incompatible y no tiene solución.