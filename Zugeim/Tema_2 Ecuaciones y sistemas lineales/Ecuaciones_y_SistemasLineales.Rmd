---
title: "Ecuaciones y sistemas lineales"
author: "Imanol"
date: "11/3/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

knitr::opts_chunk$set(engine.path = list(matlab = "C:/Archivos de programa/MATLAB/R2020b/bin/matlab.exe"))

library(reticulate)
use_python("../../../anaconda3/envs/Curso Algebra Lineal/python.exe")
```

# R 

## Sistemas compatibles determinados.

### Sistemas compatibles determinados con *solve()*
```{r}
A = rbind(c(1,1,2),c(2,4,-3),c(3,6,-5))
b = c(9,1,0)
AB = cbind(A,b) # Unimos matriz A y b

# Comprobar si es compatible determinado
qr(A)$rank==qr(AB)$rank # Compatible
qr(A)$rank==3 # Determinado

# Resolver el sistema
solve(A,b) 

# Comprobacion
solution = c(1,2,3)
A%*%solution == b # Confirmado, nos da el vector de terminos independientes.
```


### Sistemas compatibles determinados con *matlib*
```{r}
A = rbind(c(2,2),c(-1,1))
b = c(1,2)
AB = cbind(A,b) # Unimos matriz A y b

library(matlib)

# Una vez en forma de matriz se puede mostrar
showEqn(A, b)

# Calcular rango de la matriz con matlib
R(A)
R(AB)

# Comprobar si el sistema es compatible con matlib
all.equal(R(A),R(AB))

# Resolver el sistema son matlib
Solve(A,b, fractions = TRUE) # En este cas la s es mayuscula.
                             # Si fractions es TRUE nos lo muestra en fracciones
```

### Representación de Sistemas.

Se hace uso de la libreria `matlib()` y mediante *plotEqn()* si tenemos 2 incognitas o *plotEqn3()* si tenemos 3 incognitas.
```{r}
library(matlib)

# Representacion con plotEqn()

## Dos Incognitas

### Dos ecuaciones
A = rbind(c(2,2),c(-1,1))
b = c(1,2)
AB = cbind(A,b) # Unimos matriz A y b
plotEqn(A,b)

points(-3/4,5/4, col = "turquoise1", pch = 19) # Para dibujar puntos con ciertas caracteristicas

#### Tres ecuaciones
A = rbind(c(4,2),c(1,-2),c(3,4))
b = c(3,2,1)
showEqn(A,b)
plotEqn(A,b)

## Tres Incognitas

A = rbind(c(1,1,2),c(2,4,-3),c(3,6,-5))
b = c(9,1,0)
showEqn(A,b)

plotEqn3d(A,b, xlim = c(-3,3), ylim = c(0,6))
```

### Tema 2 Ejercicio 1.

#### Solución (a)
```{r}
A = rbind(c(4,2),c(1,-2),c(3,4))
b = c(3,2,1)
showEqn(A,b)

AB = cbind(A,b)

all.equal(R(A),R(AB))
```

#### Solución (b)
```{r}
# Resolvemos
Solve(A,b,fractions = T)

#Comprobamos
s = c(1,-1/2)
A%*%s == b # Efectivamente es la correcta
```


### Metodo de GAUSS.

```{r}
library(matlib)
A = rbind(c(1,1,2),c(2,4,-3),c(3,6,-5))
b = c(9,1,0)
AB = cbind(A,b)

echelon(AB) # Escalona la matriz
echelon(AB, verbose = T, fraction = T) # Verbose = True nos da los pasos que ha hecho para escalonarla y fraction = true nos mantiene las fracciones.
```

## Sistemas compatibles indeterminados.

La función solve no funcionara.
```{r}
library(matlib)
A = matrix(c(1,1,-1,1,-1,1,3,1,-1), byrow = TRUE, nrow = 3, ncol = 3)
b = c(2,1,5)
AB = cbind(A,b)

# Comprobamos rangos de las matrices
c(R(A),R(AB))
all.equal(R(A),R(AB)) 

# echelon tambien nos puede decir que es indeterminado
echelon(AB)

# En caso de no verlo claro se puede usar solve() para ver quien es la variable dependiente
Solve(A,b, fractions = T) # X2 es dependiente de X3

# Tambien se puede ver dibujando que tiene infinitas soluciones
plotEqn3d(A,b, xlim = c(-10,10), ylim = c(-10,10), zlim = c(-10,10))
```

## Sistemas Incompatibles.

```{r}
library(matlib)
A = cbind(c(1,1,2),c(1,-1,1))
b = c(2,1,3)
AB = cbind(A,b)

# Comprobamos rangos de las matrices
c(R(A),R(AB))
all.equal(R(A),R(AB)) # Existe diferencia, es incompatible

# Nos dan resultados que son mentira 0 = 1 y 0 = 1/3
echelon(AB)
Solve(A,b, fractions = T) 

# Tambien se puede ver dibujando que tiene infinitas soluciones
plotEqn(A,b, xlim = c(0,2), ylim = c(0,1.5)) # No existe epunto comun a los 3
```
## Ecuaciones matriciales.

Dada una ecuación matricial, si la tenemos de la siguiente forma $AX = B$, donde $A,B$ son matrices, entonces la podemos resolver haciendo uso de la función `solve(A,B)`

**Ejemplo 6**

Sea la ecuación matricial $$AX + 3B = (C+D)X+3D+10I_2$$ donde $$A =\begin{pmatrix}0 & 4\\2 & 1\end{pmatrix},\quad B =\begin{pmatrix}1 & -1\\ 2 & 3\end{pmatrix},\quad C =\begin{pmatrix}1 & 2\\ 3 & -2\end{pmatrix},\quad D =\begin{pmatrix}-2 & 1\\ -1 & 1\end{pmatrix},\quad I_2 =\begin{pmatrix}1 & 0\\ 0 & 1\end{pmatrix}$$

Pasando los términos multiplicados por $X$ a la izquierda y los que no a la derecha, obtenemos

$$AX-(C+D)X = 3D-3B+10I_2$$

Sacando factor común $X$ por la derecha en el primer término y factor común 3 en el segundo término, tenemos

$$(A-(C+D))X = 3(D-B)+10I_2$$
```{r}
library(matlib)
A = rbind(c(0,4),c(2,1))
B = rbind(c(1,-1),c(2,3))
C = rbind(c(1,2),c(3,-2))
D = rbind(c(-2,1),c(-1,1))
I = diag(1, nrow = 2, ncol = 2)

#La matriz que multiplica a X, a la que llamaremos M, es
M = A-(C+D)

# Mientras que la matriz del segundo miembro de la igualdad, N, es
N = 3*(D-B)+10*I


# Una vez calculadas M y N, tenemos la ecuación matricial de la forma MX = N. Entonces, la podemos resolver realizando lo siguiente:
X = solve(M,N)
X

# Comprobamos nuestro resultado:
A%*%X + 3*B == (C+D)%*%X+3*D+10*I
```