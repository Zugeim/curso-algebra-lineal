---
title: "Factorizacio_LU"
author: "Imanol"
date: "13/3/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

knitr::opts_chunk$set(engine.path = list(matlab = "C:/Archivos de programa/MATLAB/R2020b/bin/matlab.exe"))

library(reticulate)
use_python("../../../anaconda3/envs/Curso Algebra Lineal/python.exe")

```

# R 

## Factorizaciones LU sin permutación
```{r}
library(matlib)

A = rbind(c(1,3,0,-1),c(2,1,-1,5),c(0,-2,3,-1),c(1,1,3,1))
luA = LU(A)

# Le  puedo pedir la matriz P (sera la matriz identidad porque no he permutado ninguna fila)
luA$P

# Le puedo pedir la matriz L
luA$L

# Le puedo pedri la matriz U
luA$U

# Comprobacion 
luA$L%*%luA$U == A
```

## Factorizaciones LU con permutación
```{r}
library(matlib)

A = rbind(c(0,1,3),c(1,3,-2),c(-3,-2,-1))
luA = LU(A)

# Le  puedo pedir la matriz P (se ha permutado la primera y segunda fila)
luA$P

# Le puedo pedir la matriz L
luA$L

# Le puedo pedri la matriz U
luA$U

# Comprobacion 
luA$P%*%luA$L%*%luA$U == A
```

## Resolver sistemas

```{r}
library(matlib)

A = rbind(c(0,1,3),c(1,3,-2),c(-3,-2,-1))
b = c(1,3,-2)

sistema = LU(A,b)

# Le  puedo pedir la matriz P (se ha permutado la primera y segunda fila)
sistema$P

# Le puedo pedir la matriz L
sistema$L

# Le puedo pedri la matriz U
sistema$U

# Solucion del sistema L*d = b
sistema$d

# SOlucion del sistema
sistema$x
```

# Python 

## Factorizaciones LU sin permutación
```{python}
import scipy
import scipy.linalg

A = scipy.array([[1,3,0,-1], [2,1,-1,5], [0,-2,3,-1], [1,1,3,1]])
P, L, U = scipy.linalg.lu(A)

# Le  puedo pedir la matriz P 
P # No era neceraria la permutacion pero python lo ha visto oportuno

# Le puedo pedir la matriz L
L

# Le puedo pedri la matriz U
U

# Comprobacion 
(P.dot(L)).dot(U) == A
```

## Factorizaciones LU con permutación
```{python}
import scipy
import scipy.linalg

A = scipy.array([[0,1,3], [1,3,-2], [-3,-2,-1]])
P, L, U = scipy.linalg.lu(A)

# Le  puedo pedir la matriz P 
P # No era neceraria la permutacion pero python lo ha visto oportuno

# Le puedo pedir la matriz L
L

# Le puedo pedri la matriz U
U

# Comprobacion 
(P.dot(L)).dot(U) == A
```

## Reducir la informacion del metodo LU

Se usa esto para ahorrar memoria teniendo muillones de datos
```{python}
import scipy
import scipy.linalg

A = scipy.array([[0,1,3], [1,3,-2], [-3,-2,-1]])
LU, piv = scipy.linalg.lu_factor(A)

# L y U juntas
LU # Diagonal superior U y la inferior L

# Nos da que filas fueron intercambiadas
piv # La primera fila ha sido cambiada por la tercera (0->2), la segunda fila se mantiene (1) y la tercera fila se cambio por la 1.
```

## Resolver sistemas

```{python}
import scipy
import scipy.linalg

A = scipy.array([[0,1,3], [1,3,-2], [-3,-2,-1]])

LU, piv = scipy.linalg.lu_factor(A)

b = [1, 3, -2]

x = scipy.linalg.lu_solve((LU,piv),b)
x
```

# Matlab

## Factorizaciones LU sin permutación
```{matlab}

A = [1,3,0,-1; 2,1,-1,5; 0,-2,3,-1; 1,1,3,1]
[L,U,P] = lu(A)

# Comprobacion 
P*L*U == A
```

## Factorizaciones LU con permutación
```{matlab}
A = [0 1 3; 1 3 -2; -3 -2 -1]
[L,U,P] = lu(A)

# Comprobacion 
P*L*U == A
```